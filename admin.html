<!DOCTYPE html>
<html lang="sq">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADMIN | KANAL DRENAS</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    
    <style>
        body { background: #000; color: white; font-family: 'Segoe UI', Arial, sans-serif; margin: 0; display: flex; align-items: center; justify-content: center; min-height: 100vh; }
        #login-screen { background: #0d0d0d; padding: 40px; border-radius: 15px; border: 1px solid #222; width: 100%; max-width: 380px; text-align: center; }
        .logo-login { margin-bottom: 30px; font-size: 26px; text-transform: uppercase; font-weight: bold; }
        .logo-login span { background: #ffcc00; color: #000; padding: 5px 12px; border-radius: 5px; margin-right: 5px; }
        .input-group { text-align: left; margin-bottom: 20px; }
        label { display: block; color: #ffcc00; font-size: 12px; font-weight: bold; margin-bottom: 8px; text-transform: uppercase; }
        input, textarea, select { width: 100%; padding: 14px; background: #1a1a1a; border: 1px solid #333; color: #fff; border-radius: 8px; box-sizing: border-box; }
        #login-btn, #publish-btn { width: 100%; padding: 16px; background: #ffcc00; color: #000; border: none; border-radius: 8px; font-weight: 900; cursor: pointer; text-transform: uppercase; margin-top: 15px; }
        #admin-panel { display: none; width: 100%; max-width: 700px; padding: 20px; margin: 40px auto; }
        .admin-box { background: #0d0d0d; padding: 30px; border-radius: 15px; border: 1px solid #222; }
        .upload-section { background: #151515; padding: 20px; border-radius: 10px; border: 2px dashed #333; margin-bottom: 25px; text-align: center; }
        #status { color: #ffcc00; font-size: 13px; margin-top: 12px; font-weight: bold; }
        .item { background: #111; padding: 15px; margin-top: 10px; display: flex; justify-content: space-between; align-items: center; border-radius: 8px; border: 1px solid #222; }
        .btn-del { background: transparent; color: #ff4444; border: 1px solid #ff4444; padding: 6px 12px; border-radius: 5px; cursor: pointer; }
    </style>
</head>
<body>

    <div id="login-screen">
        <div class="logo-login"><span>KANAL</span>DRENAS</div>
        <div class="input-group">
            <label>Përdoruesi</label>
            <input type="text" id="user_f" placeholder="admin">
        </div>
        <div class="input-group">
            <label>Fjalëkalimi</label>
            <input type="password" id="pass_f" placeholder="••••••••">
        </div>
        <button id="login-btn" onclick="hyr()">HYR NË PANEL</button>
    </div>

    <div id="admin-panel">
        <div class="admin-box">
            <h2 style="color:#ffcc00; text-align:center;">PANELI I POSTIMEVE</h2>
            
            <div class="upload-section">
                <label style="color:#ffcc00;">NGARKO FOTO NGA TELEFONI/PC</label>
                <input type="file" id="file_in" accept="image/*" onchange="uploadToImgBB()" style="margin-top:10px;">
                <div id="status">Gati për ngarkim...</div>
            </div>

            <label>Titulli i Lajmit</label>
            <input type="text" id="t">
            <label>Foto URL (Mbushet vetë)</label>
            <input type="text" id="f">
            <label>YouTube Link (Opsionale)</label>
            <input type="text" id="v">
            <label>Kategoria</label>
            <select id="k">
                <option value="KRYESORE">KRYESORE</option>
                <option value="DRENICA">DRENICA</option>
                <option value="SPORT">SPORT</option>
                <option value="DIASPORA">DIASPORA</option>
                <option value="SHOWBIZ">SHOWBIZ</option>
            </select>
            <label>Përmbajtja</label>
            <textarea id="p" rows="8"></textarea>
            <button id="publish-btn" onclick="ruaj()">PUBLIKO LAJMIN</button>
            <div id="list" style="margin-top:30px;"></div>
        </div>
    </div>

    <script>
        const API_KEY = "eb62a6907856c805db10887e57fa34ea";

        function hyr() {
            if(document.getElementById('user_f').value === "admin" && document.getElementById('pass_f').value === "DRENASI2026") {
                document.getElementById('login-screen').style.display = 'none';
                document.getElementById('admin-panel').style.display = 'block';
            } else { alert("Gabim!"); }
        }

        const firebaseConfig = {
            apiKey: "AIzaSyBh_7BwfNbKbscPSW1ZN9Y_UvAntsjl9Wg",
            authDomain: "herolind-6ca5f.firebaseapp.com",
            databaseURL: "https://herolind-6ca5f-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "herolind-6ca5f",
            storageBucket: "herolind-6ca5f.appspot.com",
            messagingSenderId: "893085364638",
            appId: "1:893085364638:web:2db59e6ec72ad7e7c1a68f"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        function uploadToImgBB() {
            const fileInput = document.getElementById('file_in');
            const status = document.getElementById('status');
            const file = fileInput.files[0];
            if (!file) return;

            status.innerText = "Duke u ngarkuar...";
            const formData = new FormData();
            formData.append("image", file);

            fetch(`https://api.imgbb.com/1/upload?key=${API_KEY}`, {
                method: "POST",
                body: formData
            })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    document.getElementById('f').value = data.data.url;
                    status.innerText = "✅ U ngarkua me sukses!";
                } else {
                    status.innerText = "❌ Gabim gjatë ngarkimit.";
                }
            })
            .catch(() => { status.innerText = "❌ Lidhja dështoi."; });
        }

        function ruaj() {
            const t = document.getElementById('t').value;
            const f = document.getElementById('f').value;
            const p = document.getElementById('p').value;
            if(t && f && p) {
                db.ref('lajmet').push({
                    titulli: t, foto: f, pershkrimi: p,
                    kategoria: document.getElementById('k').value,
                    video: document.getElementById('v').value,
                    data: Date.now()
                }).then(() => { alert("U publikua!"); location.reload(); });
            } else { alert("Plotëso Titullin, Foton dhe Tekstin!"); }
        }

        db.ref('lajmet').on('value', (snap) => {
            const l = document.getElementById('list'); l.innerHTML = '';
            let items = [];
            snap.forEach((c) => { items.push({id: c.key, ...c.val()}); });
            items.reverse().forEach((i) => {
                l.innerHTML += `<div class="item"><span>${i.titulli}</span><button class="btn-del" onclick="db.ref('lajmet/${i.id}').remove()">Fshij</button></div>`;
            });
        });
    </script>
</body>
</html>
