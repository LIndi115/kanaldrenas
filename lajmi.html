<!DOCTYPE html>
<html lang="sq">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LAJMI | KANAL DRENAS</title>
    
    <meta property="og:type" content="article">
    <meta property="og:url" id="fb-url" content="">
    <meta property="og:title" id="fb-title" content="KANAL DRENAS">
    <meta property="og:description" id="fb-desc" content="Lexoni lajmin e plotë në Kanal Drenas">
    <meta property="og:image" id="fb-img" content="https://lindi115.github.io/kanaldrenas/logo.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        :root { --verdh: #ffcc00; --zi: #000; --gri: #111; }
        body { background: var(--zi); color: white; font-family: 'Segoe UI', sans-serif; margin: 0; padding: 0; }
        
        header { background: #1a1a1a; padding: 15px; text-align: center; border-bottom: 2px solid var(--verdh); position: sticky; top: 0; z-index: 1000; }
        .logo { text-decoration: none; color: white; font-size: 22px; font-weight: bold; text-transform: uppercase; }
        
        .container { max-width: 800px; margin: 20px auto; padding: 20px; background: var(--gri); border-radius: 12px; }
        
        h1 { color: var(--verdh); margin-top: 10px; font-size: 28px; line-height: 1.3; }
        
        .meta-info { border-bottom: 1px solid #333; padding-bottom: 15px; margin-bottom: 20px; color: #888; font-size: 14px; }
        .meta-info strong { color: var(--verdh); }

        .main-img { width: 100%; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.5); }
        
        #video-box { margin-top: 25px; background: #000; border-radius: 10px; overflow: hidden; }
        
        .content { line-height: 1.8; font-size: 18px; color: #ddd; margin-top: 25px; white-space: pre-wrap; }
        
        .btn-back { display: inline-block; margin-top: 30px; color: var(--verdh); text-decoration: none; font-weight: bold; border: 1px solid var(--verdh); padding: 10px 20px; border-radius: 5px; transition: 0.3s; }
        .btn-back:hover { background: var(--verdh); color: black; }
        
        footer { text-align: center; padding: 40px; color: #555; font-size: 13px; }
    </style>
</head>
<body>

    <header>
        <a href="index.html" class="logo">KANAL <span style="background:var(--verdh); color:#000; padding:2px 5px; border-radius:3px;">DRENAS</span></a>
    </header>

    <div class="container">
        <div id="lajmi-full">
            <h1 id="titulli">Duke u ngarkuar lajmi...</h1>
            
            <div class="meta-info">
                <span id="autor"></span> | <span id="data"></span>
            </div>

            <img id="foto" class="main-img" src="" alt="" style="display:none;">
            
            <div id="video-box"></div>

            <div class="content">
                <p id="teksti"></p>
            </div>

            <a href="index.html" class="btn-back">← KTHEHU TE BALLINA</a>
        </div>
    </div>

    <footer>
        &copy; 2026 KANAL DRENAS. Të gjitha të drejtat e rezervuara.
    </footer>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyBh_7BwfNbKbscPSW1ZN9Y_UvAntsjl9Wg",
            authDomain: "herolind-6ca5f.firebaseapp.com",
            databaseURL: "https://herolind-6ca5f-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "herolind-6ca5f",
            storageBucket: "herolind-6ca5f.appspot.com",
            messagingSenderId: "893085364638",
            appId: "1:893085364638:web:2db59e6ec72ad7e7c1a68f"
        };
        firebase.initializeApp(firebaseConfig);

        function merrYoutubeID(url) {
            if (!url) return null;
            let videoId = "";
            if (url.includes("v=")) {
                videoId = url.split('v=')[1].split('&')[0];
            } else if (url.includes("youtu.be/")) {
                videoId = url.split('youtu.be/')[1].split('?')[0];
            } else if (url.includes("embed/")) {
                videoId = url.split('embed/')[1];
            }
            return videoId;
        }

        const urlParams = new URLSearchParams(window.location.search);
        const lajmiId = urlParams.get('id');

        if(lajmiId) {
            firebase.database().ref('lajmet/' + lajmiId).on('value', (snap) => {
                const data = snap.val();
                if(data) {
                    // Vendos të dhënat në HTML
                    document.getElementById('titulli').innerText = data.titulli;
                    document.title = data.titulli + " | KANAL DRENAS";
                    document.getElementById('teksti').innerText = data.pershkrimi;

                    // Përditëso Meta Tags për Facebook
                    document.getElementById('fb-title').setAttribute('content', data.titulli);
                    document.getElementById('fb-desc').setAttribute('content', data.pershkrimi.substring(0, 150) + "...");
                    document.getElementById('fb-url').setAttribute('content', window.location.href);

                    if(data.foto) {
                        document.getElementById('fb-img').setAttribute('content', data.foto);
                        const imgTag = document.getElementById('foto');
                        imgTag.src = data.foto;
                        imgTag.style.display = "block";
                    }

                    const koha = new Date(data.data);
                    document.getElementById('autor').innerHTML = "Nga: <strong>" + (data.autor || "Redaksia") + "</strong>";
                    document.getElementById('data').innerText = koha.toLocaleDateString('sq-AL', { day: 'numeric', month: 'long', year: 'numeric' });

                    // Rregullimi i Videos
                    if(data.video && data.video.trim() !== "") {
                        const vId = merrYoutubeID(data.video);
                        if(vId) {
                            document.getElementById('video-box').innerHTML = `
                                <div style="position:relative; padding-bottom:56.25%; height:0; overflow:hidden;">
                                    <iframe 
                                        style="position:absolute; top:0; left:0; width:100%; height:100%; border:0;" 
                                        src="https://www.youtube.com/embed/${vId}" 
                                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                                        allowfullscreen>
                                    </iframe>
                                </div>`;
                        }
                    }
                } else {
                    document.getElementById('titulli').innerText = "Lajmi nuk u gjet!";
                }
            });
        } else {
            window.location.href = "index.html";
        }
    </script>
</body>
</html>
